# 구현 계획

- [x] 1. 프로젝트 구조 및 의존성 설정





  - Node.js 프로젝트 초기화 (package.json, tsconfig.json)
  - 필수 패키지 설치 (@modelcontextprotocol/sdk, typescript, fast-check, vitest)
  - 디렉토리 구조 생성 (src/, tests/)
  - _요구사항: 7.1_

- [x] 2. 핵심 데이터 모델 및 타입 정의





  - Session 인터페이스 및 관련 타입 정의
  - MCP 도구 인자 인터페이스 정의 (ConnectArgs, SendArgs, ReadArgs 등)
  - Telnet 프로토콜 상수 정의 (IAC, DO, DONT, WILL, WONT 등)
  - _요구사항: 1.1, 2.1, 3.1, 4.1, 5.1_

- [x] 3. Telnet 프로토콜 핸들러 구현





  - [x] 3.1 Telnet 프로토콜 상수 및 기본 구조 작성


    - IAC 시퀀스 감지 및 파싱 함수 구현
    - 옵션 협상 응답 생성 함수 구현
    - _요구사항: 8.1, 8.2_

  - [x] 3.2 속성 테스트: IAC 시퀀스 처리


    - **속성 10: IAC 시퀀스 처리**
    - **검증: 요구사항 8.1**

  - [x] 3.3 속성 테스트: Telnet 옵션 협상 응답


    - **속성 11: Telnet 옵션 협상 응답**
    - **검증: 요구사항 8.2**

- [x] 4. Telnet 클라이언트 세션 구현






  - [x] 4.1 TelnetSession 클래스 기본 구조 작성

    - TCP 소켓 연결 로직 구현 (connect 메서드)
    - 연결 타임아웃 처리
    - 세션 ID 생성 (UUID)
    - _요구사항: 1.1, 1.2, 1.4, 1.5_


  - [x] 4.2 속성 테스트: 연결 성공 시 고유 세션 생성

    - **속성 1: 연결 성공 시 고유 세션 생성**
    - **검증: 요구사항 1.1, 1.2**



  - [x] 4.3 명령 전송 기능 구현 (sendCommand 메서드)
    - 명령 문자열에 CRLF 추가
    - 소켓 쓰기 오류 처리


    - _요구사항: 2.1, 2.2_


  - [x] 4.4 속성 테스트: 명령 전송 시 CRLF 추가
    - **속성 2: 명령 전송 시 CRLF 추가**
    - **검증: 요구사항 2.1, 2.2**

  - [x] 4.5 버퍼 관리 및 데이터 수신 구현


    - 소켓 'data' 이벤트 핸들러 작성
    - 버퍼에 데이터 자동 추가


    - 버퍼 크기 제한 및 FIFO 방식 오래된 데이터 제거
    - _요구사항: 3.4, 6.4_


  - [x] 4.6 속성 테스트: 데이터 수신 시 자동 버퍼링
    - **속성 4: 데이터 수신 시 자동 버퍼링**
    - **검증: 요구사항 3.4**

  - [x] 4.7 속성 테스트: 버퍼 크기 제한 준수


    - **속성 8: 버퍼 크기 제한 준수**
    - **검증: 요구사항 6.4**


  - [x] 4.8 응답 읽기 기능 구현 (readResponse 메서드)
    - 버퍼에서 데이터 읽기

    - 읽기 후 버퍼 비우기
    - 다양한 인코딩 지원 (utf8, base64, hex, binary)
    - 대기 옵션 처리 (waitMs)

    - _요구사항: 3.1, 3.2, 3.3, 3.5, 8.3, 8.4_

  - [x] 4.9 속성 테스트: 버퍼 읽기 후 비우기

    - **속성 3: 버퍼 읽기 후 비우기**
    - **검증: 요구사항 3.1, 3.2**

  - [x] 4.10 속성 테스트: UTF-8 디코딩 정확성
    - **속성 13: UTF-8 디코딩 정확성**


    - **검증: 요구사항 8.3**


  - [x] 4.11 속성 테스트: ANSI 제어 코드 보존
    - **속성 14: ANSI 제어 코드 보존**
    - **검증: 요구사항 8.4**


  - [x] 4.12 속성 테스트: 이진 데이터 라운드트립
    - **속성 12: 이진 데이터 라운드트립**
    - **검증: 요구사항 8.3**

  - [x] 4.13 연결 종료 기능 구현 (disconnect 메서드)
    - 소켓 닫기
    - 리소스 정리
    - 멱등성 보장 (이미 닫힌 연결 재호출 시 오류 없음)
    - _요구사항: 4.1, 4.2, 4.3_

  - [x] 4.14 속성 테스트: 세션 종료 시 리소스 정리
    - **속성 5: 세션 종료 시 리소스 정리**
    - **검증: 요구사항 4.1, 4.2**

  - [x] 4.15 속성 테스트: 연결 해제의 멱등성
    - **속성 6: 연결 해제의 멱등성**
    - **검증: 요구사항 4.3**

  - [x] 4.16 오류 처리 구현
    - 예기치 않은 연결 끊김 처리 (소켓 'close', 'error' 이벤트)
    - 세션 비활성 상태 표시
    - _요구사항: 6.1, 6.2, 6.3_

- [x] 5. 세션 관리자 구현





  - [x] 5.1 SessionManager 클래스 작성


    - 세션 저장소 (Map<string, TelnetSession>)
    - createSession 메서드 구현
    - getSession 메서드 구현
    - deleteSession 메서드 구현
    - listSessions 메서드 구현
    - _요구사항: 1.1, 1.2, 4.1, 4.2, 5.1, 5.2, 5.3_

  - [x] 5.2 속성 테스트: 세션 목록 완전성


    - **속성 7: 세션 목록 완전성**
    - **검증: 요구사항 5.1, 5.2**

- [x] 6. 체크포인트 - 모든 테스트 통과 확인





  - 모든 테스트가 통과하는지 확인하고, 문제가 있으면 사용자에게 질문합니다.

- [x] 7. MCP 서버 구현





  - [x] 7.1 MCP Server 초기화


    - @modelcontextprotocol/sdk를 사용하여 서버 인스턴스 생성
    - StdioServerTransport 설정
    - 서버 메타데이터 설정 (name, version)
    - _요구사항: 7.1_

  - [x] 7.2 MCP 도구 등록


    - telnet_connect 도구 스키마 및 핸들러 등록
    - telnet_send 도구 스키마 및 핸들러 등록
    - telnet_read 도구 스키마 및 핸들러 등록
    - telnet_disconnect 도구 스키마 및 핸들러 등록
    - telnet_list 도구 스키마 및 핸들러 등록
    - _요구사항: 7.2, 7.3_

  - [x] 7.3 속성 테스트: 도구 호출 라우팅


    - **속성 9: 도구 호출 라우팅**
    - **검증: 요구사항 7.3, 7.4**

  - [x] 7.4 도구 핸들러 구현


    - 각 도구에 대한 비즈니스 로직 작성
    - SessionManager와 통합
    - 입력 검증 및 오류 처리
    - MCP 프로토콜 형식으로 응답 반환
    - _요구사항: 1.1, 1.2, 1.3, 2.1, 2.3, 2.4, 3.1, 3.3, 4.1, 5.1, 7.4_

  - [x] 7.5 서버 시작 및 메시지 처리


    - 서버 시작 로직 작성
    - JSON-RPC 메시지 처리
    - 표준 입출력 통신 설정
    - _요구사항: 7.1_

- [x] 8. 최종 체크포인트 - 모든 테스트 통과 확인





  - 모든 테스트가 통과하는지 확인하고, 문제가 있으면 사용자에게 질문합니다.
